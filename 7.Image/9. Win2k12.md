

## 1. Cài đặt máy ảo 

- Sử dụng VirtIO đã tải ở phần chuẩn bị. Dùng virt-install để khởi động máy ảo 

- Chọn ISO Win 2012 và OS refer
![](https://i.imgur.com/CJ8bUcE.png)

- Chọn RAM và CPU
![](https://i.imgur.com/sdMPCjQ.png)

- Chọn DISK SPACE :15 GB
![](https://i.imgur.com/o9TyDUZ.png)

- Chọn Customize cấu hình
![](https://i.imgur.com/mELQizN.png)

- Thực hiện thêm một CDROM cho virtIO ISO
![](https://i.imgur.com/9MTV5Ju.png)

- Trên Disk 1 (disk máy ảo ),. Chọn disk bus : VirtIO cho disk 
![](https://i.imgur.com/zdEihIZ.png)


- Tại network card chọn virtIO
![](https://i.imgur.com/Y1HQRRC.png)

- Tại Boot MENU chọn lại boot order
![](https://i.imgur.com/g6FWJdn.png)

- Sau đó bắt đầu cài đặt OS
![](https://i.imgur.com/HibESaO.png)

- Lựa chọn "Install Now"
![](https://i.imgur.com/UOMhJZt.png)


- Nhập key để cài đặt 
![](https://i.imgur.com/WgIpz8l.png)


- Cài đặt Win 2012 R2 GUI
![](https://i.imgur.com/SE0p6Sn.png)

- Chọn Acccept License
![](https://i.imgur.com/kDkkEmw.png)


- Chọn Custom Install
![](https://i.imgur.com/PYB4g6k.png)


- Với VirtIO, Win Srv sẽ chưa có driver để load disk 
![](https://i.imgur.com/WgIpz8l.png)

- Thực hiện load driver từ ISO VirtIO với đường dẫn như sau
![](https://i.imgur.com/VLGHkHP.png)

- Chọn ổ đĩa cài đặt 
![](https://i.imgur.com/8J8l7Rl.png)

- Quá trình cài đặt bắt đầu
![](https://i.imgur.com/OYx23jz.png)



## 3. Cấu hình trên Win Server 2012 R2


### 3.1. Caài đặt ban đầu

- Sau khi reboot máy ảo, set pasword cho tài khoản Administrator
![](https://i.imgur.com/Ai5SYYV.png)


- Thực hiện add network device VirtIO bằng cách Run >  devmgmt.msc
![](https://i.imgur.com/7q9Ek1N.png)
![](https://i.imgur.com/h5JE9Hs.png)


- Chọn device cho Ethernet Controller. NetKVM -> Win2k12R-> amd64
![](https://i.imgur.com/7q9Ek1N.png)


- Sau khi cài đặt thành công network device
![](https://i.imgur.com/Mz2QUTD.png)


- Enable Remote Desktop và Tắt Firewall
![](https://i.imgur.com/62fnQ05.png)

![](https://i.imgur.com/mvxnTa7.png)

![](https://i.imgur.com/eeSdsQr.png)


### 3.3. Cài đặt Baloon driver 

- Cài đặt Baloon driver cho RAM. Copy /virtio-win-0.1.1/Baloon/2k12R2/amd64 từ CD Drive vào C:\ 
![](https://i.imgur.com/iK4GW6h.png)


- Thực hiện mở Power Shell và cài đặt blnsrv.exe
![](https://i.imgur.com/bkQzyRh.png)

- Cài đặt Balon driver  cho CPU .
![](https://i.imgur.com/nsk96pF.png)

![](https://i.imgur.com/UV6id1g.png)

![](https://i.imgur.com/lsZ5tME.png)

![](https://i.imgur.com/jL6Xt0I.png)



### 3.2. Cài đặt QEMU guest-agent 


- Cài đặt qemu-ga-x86_64
![](https://i.imgur.com/778cgdF.png)


- Kiểm tra Service
![](https://i.imgur.com/CqKsSrh.png)


### 3.3 . Cài đặt Cloud-init 


- Enable chức năng download trên Internet Security Setting
![](https://i.imgur.com/aBhuhDC.png)

- Active scripting
![](https://i.imgur.com/cIRLNpb.png)

- Tải về cloud base cho Windows
