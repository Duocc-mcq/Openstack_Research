


## 1. Khởi tạo VM

- Lựa chọn ISO và OS refer
![](https://i.imgur.com/l0DSSgT.png)

- Lựa chọn RAM và CPU
![](https://i.imgur.com/bTHBR4n.png)

- Lựa chọn DISK
![](https://i.imgur.com/DeqV88K.png)

- Tên máy ảo và network
![](https://i.imgur.com/pO69iBU.png)


## 2. Cài đặt OS

- Lựa chọn ngôn ngữ cài đặt
![](https://i.imgur.com/R9F3vod.png)


- Lựa chọn keyboard layout
![](https://i.imgur.com/mSUCEw2.png)


- Lựa chọn "install ubuntu"
![](https://i.imgur.com/3MGDbXP.png)


- Cấu hình mạng
![](https://i.imgur.com/8t8D575.png)


- Cấu hình Proxy
![](https://i.imgur.com/CP3cqAz.png)

- Cấu hình Mirro URL
![](https://i.imgur.com/ZITdWbx.png)

- Lựa chọn cấu hình partion theo thủ công
![](https://i.imgur.com/7LITWK5.png)


- Format Partion về ext4, mount tại /, không khởi tạo LVM group
![](https://i.imgur.com/bauKddx.png)

- Chọn và0 disk, Lựa chọn "Make disk device"
![](https://i.imgur.com/4neaiip.png)


- Sau khi đã lựa chọn, thực hiện khởi tạo một partion trên disk, filesystem ext4
![](https://i.imgur.com/U3eQKnf.png)

- Done cấu hình disk
![](https://i.imgur.com/UiWMJUY.png)


- Cấu hình Username và Password
![](https://i.imgur.com/0bYoUKb.png)

- Lựa chọn cài đặt OpenSSH server
![](https://i.imgur.com/GlqTll7.png)

- Bỏ qua việc cài đặt package
![](https://i.imgur.com/DkJTYm8.png)


- Reboot VM
![](https://i.imgur.com/eG1LnH5.png)



## 3. Cấu hình trong VM


- Đặt passwd cho user root và switch sang 
```
sudo passwd root
su root 
```

- Exit và đăng nhập tài khoản root
```
exit
root
```


- Cho phép ssh vào bằng tài khoản root bằng password
```
sed -i "s|#PermitRootLogin.*|PermitRootLogin yes|" /etc/ssh/sshd_config
```
- Khởi động lại service 
```
service sshd restart
```

- Tắt Firewalld
```
ufw disable
iptables -F
iptables-save
```

- Xoá user ubuntu
```
userdel -r ubuntu
```

- Update packagee
```
apt-get update
apt-get upgrade
apt-get dist-upgrade

```


- Thay đổi timezone. Lựa chọn Asia/Ho_Chi_Minh
```
dpkg-reconfigure tzdata
```

- Disable IPv6 Module
```
    echo "net.ipv6.conf.all.disable_ipv6 = 1" >> /etc/sysctl.conf 
    echo "net.ipv6.conf.default.disable_ipv6 = 1" >> /etc/sysctl.conf 
    echo "net.ipv6.conf.lo.disable_ipv6 = 1" >> /etc/sysctl.conf
    sysctl -p
```

- Cài đặt cloud init và grow root disk
```
apt-get install cloud-utils cloud-initramfs-growroot cloud-init -y

```

- Cấu hình cloud-init, chỉ lựa chọn EC2
```
dpkg-reconfigure cloud-init

```

![](https://i.imgur.com/NMYI3Ef.png)


- Tắt warning cloud-init khi boot VM
```
mkdir -p /var/lib/cloud/instance/warnings
touch /var/lib/cloud/instance/warnings/.skip
```


- Cấu hình cloud-init
```
sed -i 's|name: ubuntu|user: root|g' /etc/cloud/cloud.cfg
sed -i 's|disable_root: true|disable_root: false|g' /etc/cloud/cloud.cfg
```


- Xoá cơ chế gen network int
```
echo > /lib/udev/rules.d/75-persistent-net-generator.rules
echo > /etc/udev/rules.d/70-persistent-net.rules
```